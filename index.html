<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Office Report Practice</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-slate-50 to-slate-200 min-h-screen p-4">
    <div class="max-w-7xl mx-auto">
        <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
            <h1 class="text-3xl font-bold text-gray-800 mb-2">ðŸ“Š Office Report Practice</h1>
            <p class="text-gray-600">Generate data and practice Excel skills</p>
        </div>

        <div class="grid md:grid-cols-3 gap-4 mb-6">
            <button onclick="generateData('employee')" class="bg-blue-500 hover:bg-blue-600 text-white rounded-xl p-6 shadow-lg transition">
                <div class="text-4xl mb-2">ðŸ‘¥</div>
                <h3 class="text-xl font-bold">Employee List</h3>
                <p class="text-sm mt-2 opacity-90">50 entries</p>
            </button>
            <button onclick="generateData('sales')" class="bg-green-500 hover:bg-green-600 text-white rounded-xl p-6 shadow-lg transition">
                <div class="text-4xl mb-2">ðŸ’°</div>
                <h3 class="text-xl font-bold">Sales Report</h3>
                <p class="text-sm mt-2 opacity-90">40 entries</p>
            </button>
            <button onclick="generateData('attendance')" class="bg-purple-500 hover:bg-purple-600 text-white rounded-xl p-6 shadow-lg transition">
                <div class="text-4xl mb-2">ðŸ“…</div>
                <h3 class="text-xl font-bold">Attendance Report</h3>
                <p class="text-sm mt-2 opacity-90">30 entries</p>
            </button>
        </div>

        <div id="result" class="hidden bg-white rounded-xl shadow-lg overflow-hidden">
            <div class="bg-gradient-to-r from-indigo-500 to-purple-600 text-white p-6">
                <div class="flex justify-between items-center">
                    <div>
                        <h2 class="text-2xl font-bold" id="reportTitle"></h2>
                        <p class="text-sm opacity-90" id="reportCount"></p>
                    </div>
                    <button onclick="downloadCSV()" class="bg-green-500 hover:bg-green-600 px-4 py-2 rounded-lg font-semibold transition">
                        Download CSV
                    </button>
                </div>
            </div>
            <div class="overflow-x-auto p-6">
                <table class="w-full text-sm" id="dataTable"></table>
            </div>
        </div>
    </div>

    <script>
        const firstNames = ['Abdul','Mohammad','Ahmed','Rahim','Karim','Salam','Jamal','Kamal','Rafiq','Shafiq','Tarek','Sadiq','Nasir','Bashir','Amir','Nadir','Faruk','Monir','Tanvir','Sakib','Mahmud','Rashid','Habib','Salma','Nazma','Rumana','Shahana','Parvin','Nasrin','Sumaiya','Tasnim','Jannat','Ayesha','Fatema','Khadija'];
        const lastNames = ['Hossain','Ahmed','Ali','Khan','Chowdhury','Rahman','Islam','Haque','Mia','Sheikh','Begum','Khatun','Akter','Sultana','Karim','Uddin'];
        const departments = ['Accounting','Sales','Marketing','IT','HR','Admin','Production','Logistics'];
        const designations = ['Manager','Executive','Officer','Supervisor','Coordinator','Analyst'];
        const cities = ['Dhaka','Chattogram','Sylhet','Rajshahi','Khulna','Barishal','Rangpur'];
        
        let currentData = [];
        let currentType = '';

        function rand(arr) { return arr[Math.floor(Math.random() * arr.length)]; }
        function randNum(min, max) { return Math.floor(Math.random() * (max - min + 1) + min); }
        function randDate() {
            const d = new Date(2020 + Math.random() * 5, Math.random() * 12, Math.random() * 28);
            return d.toLocaleDateString('en-GB');
        }

        function generateData(type) {
            currentType = type;
            let data = [];
            
            if (type === 'employee') {
                for (let i = 1; i <= 50; i++) {
                    data.push({
                        ID: `EMP${String(i).padStart(4,'0')}`,
                        Name: `${rand(firstNames)} ${rand(lastNames)}`,
                        Department: rand(departments),
                        Designation: rand(designations),
                        Salary: randNum(15000, 80000),
                        City: rand(cities),
                        Mobile: `+880 1${randNum(100000000, 999999999)}`
                    });
                }
            } else if (type === 'sales') {
                for (let i = 1; i <= 40; i++) {
                    const qty = randNum(1, 50);
                    const price = randNum(1000, 50000);
                    data.push({
                        Invoice: `INV-${String(i).padStart(4,'0')}`,
                        Date: randDate(),
                        Customer: `${rand(firstNames)} ${rand(lastNames)}`,
                        Quantity: qty,
                        UnitPrice: price,
                        Total: qty * price,
                        City: rand(cities)
                    });
                }
            } else if (type === 'attendance') {
                for (let i = 1; i <= 30; i++) {
                    const present = randNum(20, 24);
                    data.push({
                        EmpID: `EMP${String(i).padStart(4,'0')}`,
                        Name: `${rand(firstNames)} ${rand(lastNames)}`,
                        Department: rand(departments),
                        Present: present,
                        Absent: randNum(0, 2),
                        Leave: randNum(0, 2),
                        Percentage: ((present/24)*100).toFixed(1) + '%'
                    });
                }
            }
            
            currentData = data;
            displayData(data, type);
        }

        function displayData(data, type) {
            document.getElementById('result').classList.remove('hidden');
            document.getElementById('reportTitle').textContent = type.charAt(0).toUpperCase() + type.slice(1) + ' Report';
            document.getElementById('reportCount').textContent = `Total ${data.length} entries`;
            
            const table = document.getElementById('dataTable');
            const headers = Object.keys(data[0]);
            
            let html = '<thead><tr class="bg-gray-100 border-b-2">';
            headers.forEach(h => html += `<th class="px-4 py-3 text-left font-bold">${h}</th>`);
            html += '</tr></thead><tbody>';
            
            data.slice(0, 10).forEach((row, i) => {
                html += `<tr class="${i % 2 === 0 ? 'bg-white' : 'bg-gray-50'} border-b hover:bg-blue-50">`;
                Object.values(row).forEach(v => {
                    html += `<td class="px-4 py-3 whitespace-nowrap">${typeof v === 'number' && v > 1000 ? v.toLocaleString() : v}</td>`;
                });
                html += '</tr>';
            });
            
            html += '</tbody>';
            table.innerHTML = html;
        }

        function downloadCSV() {
            if (currentData.length === 0) return;
            
            const headers = Object.keys(currentData[0]);
            let csv = headers.join(',') + '\n';
            
            currentData.forEach(row => {
                csv += Object.values(row).map(v => `"${v}"`).join(',') + '\n';
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${currentType}_report_${Date.now()}.csv`;
            a.click();
        }
    </script>
</body>
</html>

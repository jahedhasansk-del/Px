<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>WinGo Pro Signal - 30 Seconds</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:linear-gradient(135deg,#0a0e27 0%,#1a1f3a 100%);min-height:100vh;padding:15px;overflow-x:hidden}
.matrix-bg{position:fixed;top:0;left:0;width:100%;height:100%;z-index:0;opacity:.03;pointer-events:none}
.container{max-width:800px;margin:0 auto;position:relative;z-index:1}
.header{text-align:center;margin-bottom:20px;position:relative;background:rgba(0,255,65,.05);padding:20px;border-radius:15px;border:2px solid #00ff41;box-shadow:0 0 30px rgba(0,255,65,.3)}
.logo{font-size:32px;color:#00ff41;text-shadow:0 0 20px #00ff41;animation:glow 2s ease-in-out infinite;margin-bottom:8px;font-weight:bold}
@keyframes glow{0%,100%{text-shadow:0 0 20px #00ff41}50%{text-shadow:0 0 30px #00ff41,0 0 60px #00ff41}}
.title{color:#00ff41;font-size:14px;letter-spacing:3px;text-transform:uppercase;margin-top:5px}
.game-type{color:#ffaa00;font-size:18px;font-weight:bold;margin-top:10px;text-shadow:0 0 15px #ffaa00}
.timer-section{background:linear-gradient(135deg,rgba(255,0,85,.2) 0%,rgba(170,0,255,.2) 100%);border:2px solid #ff0055;border-radius:12px;padding:15px;margin-bottom:20px;text-align:center;box-shadow:0 0 30px rgba(255,0,85,.4)}
.next-draw{color:#00ff41;font-size:13px;margin-bottom:8px;letter-spacing:1px}
.countdown{font-size:48px;font-weight:bold;color:#ff0055;font-family:'Courier New',monospace;letter-spacing:3px;text-shadow:0 0 20px #ff0055;animation:pulse 1s infinite}
@keyframes pulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.7;transform:scale(1.05)}}
.current-time{font-size:18px;color:#00ff41;margin-top:10px;font-family:'Courier New',monospace}
.pattern-indicator{background:linear-gradient(135deg,rgba(0,255,65,.15) 0%,rgba(0,100,255,.15) 100%);border:2px solid #00ff41;border-radius:12px;padding:15px;margin-bottom:20px;text-align:center;box-shadow:0 0 25px rgba(0,255,65,.3)}
.pattern-title{color:#00ff41;font-size:14px;margin-bottom:10px;letter-spacing:2px}
.pattern-box{display:inline-block;background:rgba(0,255,65,.2);border:2px solid #00ff41;border-radius:8px;padding:10px 20px;font-size:28px;font-weight:bold;color:#00ff41;text-shadow:0 0 15px #00ff41;min-width:100px}
.pattern-a{background:rgba(0,255,65,.2);border-color:#00ff41;color:#00ff41}
.pattern-b{background:rgba(255,170,0,.2);border-color:#ffaa00;color:#ffaa00;text-shadow:0 0 15px #ffaa00}
.prediction-container{background:linear-gradient(135deg,rgba(0,255,65,.1) 0%,rgba(0,100,255,.1) 100%);border:2px solid #00ff41;border-radius:12px;overflow:hidden;box-shadow:0 0 30px rgba(0,255,65,.3);margin-bottom:20px;animation:borderPulse 2s ease-in-out infinite}
@keyframes borderPulse{0%,100%{box-shadow:0 0 30px rgba(0,255,65,.3)}50%{box-shadow:0 0 50px rgba(0,255,65,.5)}}
.prediction-header{padding:12px;text-align:center;background:linear-gradient(135deg,rgba(0,255,65,.25) 0%,rgba(0,100,255,.25) 100%);border-bottom:2px solid #00ff41}
.prediction-header h3{color:#00ff41;font-size:16px;letter-spacing:2px;text-transform:uppercase;font-weight:bold}
.prediction-content{padding:30px 20px;text-align:center}
.prediction-result{font-size:64px;font-weight:bold;margin-bottom:15px;text-transform:uppercase;letter-spacing:6px;animation:fadeInScale 1s ease-out}
@keyframes fadeInScale{0%{opacity:0;transform:scale(.5)}100%{opacity:1;transform:scale(1)}}
.prediction-big{color:#ff0055;text-shadow:0 0 25px #ff0055}
.prediction-small{color:#00ff41;text-shadow:0 0 25px #00ff41}
.prediction-details{display:grid;grid-template-columns:1fr 1fr;gap:15px;margin-top:20px;padding-top:20px;border-top:1px solid rgba(0,255,65,.3)}
.detail-box{background:rgba(0,255,65,.05);border:1px solid rgba(0,255,65,.3);border-radius:8px;padding:12px}
.detail-label{font-size:11px;color:#00ff41;margin-bottom:5px;opacity:.7;text-transform:uppercase;letter-spacing:1px}
.detail-value{font-size:20px;font-weight:bold;color:#00ff41;text-shadow:0 0 10px #00ff41}
.confidence-bar{width:200px;height:10px;background:rgba(255,255,255,.1);border-radius:5px;margin:15px auto;overflow:hidden;border:1px solid rgba(0,255,65,.3)}
.confidence-fill{height:100%;background:linear-gradient(90deg,#ff0055,#ffaa00,#00ff41);border-radius:5px;animation:fillBar 1.5s ease-out;position:relative;transition:width .5s ease}
@keyframes fillBar{0%{width:0%}}
.confidence-fill::after{content:'';position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.4),transparent);animation:shimmer 2s infinite}
@keyframes shimmer{0%{transform:translateX(-100%)}100%{transform:translateX(100%)}}
.confidence-label{color:#00ff41;font-size:13px;margin-top:8px;letter-spacing:1px;text-transform:uppercase;font-weight:bold}
.confidence-high{color:#00ff41;text-shadow:0 0 10px #00ff41}
.confidence-medium{color:#ffaa00;text-shadow:0 0 10px #ffaa00}
.confidence-low{color:#ff0055;text-shadow:0 0 10px #ff0055}
.stats-container{background:linear-gradient(135deg,rgba(0,255,65,.05) 0%,rgba(0,100,255,.05) 100%);border:1px solid rgba(0,255,65,.3);border-radius:12px;padding:20px;margin-bottom:20px;box-shadow:0 0 20px rgba(0,255,65,.2)}
.stats-info{display:grid;grid-template-columns:repeat(3,1fr);gap:15px}
.stat-item{text-align:center;padding:15px 10px;background:rgba(0,255,65,.05);border:1px solid rgba(0,255,65,.2);border-radius:8px;transition:all .3s ease}
.stat-item:hover{transform:translateY(-3px);box-shadow:0 5px 20px rgba(0,255,65,.3)}
.stat-label{font-size:10px;color:#00ff41;margin-bottom:8px;text-transform:uppercase;letter-spacing:.5px;opacity:.8}
.stat-value{font-size:26px;font-weight:bold;color:#00ff41;text-shadow:0 0 10px #00ff41}
.stat-win{color:#00ff41;text-shadow:0 0 15px #00ff41}
.stat-loss{color:#ff0055;text-shadow:0 0 15px #ff0055}
.stat-streak{color:#ffaa00;text-shadow:0 0 15px #ffaa00}
.table-container{background:linear-gradient(135deg,rgba(0,255,65,.05) 0%,rgba(0,100,255,.05) 100%);border:1px solid rgba(0,255,65,.3);border-radius:12px;overflow:hidden;box-shadow:0 0 20px rgba(0,255,65,.2);margin-bottom:20px}
table{width:100%;border-collapse:collapse}
thead{background:linear-gradient(135deg,rgba(0,255,65,.25) 0%,rgba(0,100,255,.25) 100%)}
th{padding:14px 8px;text-align:center;font-weight:600;color:#00ff41;font-size:12px;text-transform:uppercase;letter-spacing:.5px;border-bottom:2px solid #00ff41}
tbody tr{background:rgba(0,0,0,.3);transition:all .3s ease;border-bottom:1px solid rgba(0,255,65,.1)}
tbody tr:hover{background:rgba(0,255,65,.1);transform:scale(1.01);box-shadow:0 0 15px rgba(0,255,65,.3)}
td{padding:12px 8px;text-align:center;color:#00ff41;font-size:12px}
.period-cell{font-family:'Courier New',monospace;font-size:11px;opacity:.8}
.number-cell{font-size:24px;font-weight:bold}
.size-cell{font-weight:bold;font-size:13px}
.size-big{color:#ff0055;text-shadow:0 0 8px #ff0055}
.size-small{color:#00ff41;text-shadow:0 0 8px #00ff41}
.color-cell{display:flex;justify-content:center;align-items:center;gap:5px}
.color-dot{width:16px;height:16px;border-radius:50%;display:inline-block;border:2px solid rgba(0,255,65,.3);animation:dotPulse 2s infinite}
@keyframes dotPulse{0%,100%{transform:scale(1)}50%{transform:scale(1.15)}}
.red{background:#ff0055;box-shadow:0 0 10px #ff0055}
.green{background:#00ff41;box-shadow:0 0 10px #00ff41}
.violet{background:#aa00ff;box-shadow:0 0 10px #aa00ff}
.result-cell{font-weight:bold;font-size:12px;padding:6px 10px;border-radius:5px}
.result-win{color:#00ff41;background:rgba(0,255,65,.2);border:1px solid #00ff41;text-shadow:0 0 5px #00ff41}
.result-loss{color:#ff0055;background:rgba(255,0,85,.2);border:1px solid #ff0055;text-shadow:0 0 5px #ff0055}
.refresh-btn{position:fixed;bottom:25px;right:25px;background:linear-gradient(135deg,#00ff41 0%,#00aaff 100%);color:#0a0e27;border:none;padding:16px 28px;border-radius:50px;font-size:15px;font-weight:bold;cursor:pointer;box-shadow:0 0 30px rgba(0,255,65,.5);display:flex;align-items:center;gap:10px;transition:all .3s;z-index:1000;text-transform:uppercase;letter-spacing:1.5px}
.refresh-btn:hover{transform:scale(1.1);box-shadow:0 0 50px rgba(0,255,65,.8)}
.refresh-btn:active{transform:scale(.95)}
.refresh-icon{font-size:20px}
.refresh-icon.spinning{animation:spin .5s linear}
@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}
.loading{text-align:center;padding:15px;color:#00ff41;animation:blink 1s infinite}
@keyframes blink{0%,100%{opacity:1}50%{opacity:.3}}
.pattern-info{background:rgba(0,255,65,.08);border:1px solid rgba(0,255,65,.3);border-radius:8px;padding:15px;margin-bottom:20px}
.pattern-info-title{color:#00ff41;font-size:13px;font-weight:bold;margin-bottom:10px;text-align:center;letter-spacing:1px}
.pattern-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:8px}
.pattern-item{background:rgba(0,255,65,.1);border:1px solid rgba(0,255,65,.2);border-radius:5px;padding:8px 5px;text-align:center;font-size:10px}
.pattern-item-period{color:#00ff41;font-weight:bold;margin-bottom:3px}
.pattern-item-pred{color:#ffaa00;font-size:11px;font-weight:bold}
@media (max-width:600px){
.logo{font-size:24px}
.title{font-size:11px;letter-spacing:1.5px}
.game-type{font-size:14px}
.countdown{font-size:36px}
.stats-info{grid-template-columns:repeat(2,1fr);gap:10px}
.prediction-result{font-size:48px;letter-spacing:3px}
.pattern-grid{grid-template-columns:repeat(3,1fr)}
th,td{padding:10px 5px;font-size:11px}
.number-cell{font-size:20px}
.refresh-btn{bottom:15px;right:15px;padding:14px 24px;font-size:13px}
.stat-value{font-size:22px}
}
</style>
</head>
<body>
<canvas class="matrix-bg" id="matrix"></canvas>
<div class="container">
<div class="header">
<div class="logo">‚ö° WINGO PRO SIGNAL</div>
<div class="title">Advanced Pattern Analyzer v5.0</div>
<div class="game-type">üéÆ 30 SECONDS GAME</div>
</div>

<div class="timer-section">
<div class="next-draw">‚è∞ NEXT DRAW IN</div>
<div class="countdown" id="countdown">00</div>
<div class="current-time" id="currentTime">00:00:00</div>
</div>

<div class="pattern-indicator">
<div class="pattern-title">üìä CURRENT PATTERN</div>
<div class="pattern-box" id="patternBox">-</div>
<div style="margin-top:10px;font-size:11px;color:#00ff41;opacity:.7" id="patternRange">Period Range: -</div>
</div>

<div class="prediction-container">
<div class="prediction-header">
<h3>üîÆ NEXT PREDICTION</h3>
</div>
<div class="prediction-content">
<div class="prediction-result" id="currPred">
<div class="loading" style="font-size:18px">[ SCANNING... ]</div>
</div>
<div class="confidence-bar">
<div class="confidence-fill" id="confBar" style="width:0%"></div>
</div>
<div class="confidence-label" id="confLabel">ANALYZING</div>
<div class="prediction-details">
<div class="detail-box">
<div class="detail-label">Pattern Based</div>
<div class="detail-value" id="patternPred">-</div>
</div>
<div class="detail-box">
<div class="detail-label">Number Based</div>
<div class="detail-value" id="numberPred">-</div>
</div>
</div>
</div>
</div>

<div class="stats-container">
<div class="stats-info">
<div class="stat-item">
<div class="stat-label">Win</div>
<div class="stat-value stat-win" id="wc">0</div>
</div>
<div class="stat-item">
<div class="stat-label">Loss</div>
<div class="stat-value stat-loss" id="lc">0</div>
</div>
<div class="stat-item">
<div class="stat-label">Total</div>
<div class="stat-value" id="tc">0</div>
</div>
<div class="stat-item">
<div class="stat-label">Accuracy</div>
<div class="stat-value" id="wr">0%</div>
</div>
<div class="stat-item">
<div class="stat-label">Max Win</div>
<div class="stat-value stat-streak" id="mw">0</div>
</div>
<div class="stat-item">
<div class="stat-label">Max Loss</div>
<div class="stat-value stat-streak" id="ml">0</div>
</div>
</div>
</div>

<div class="table-container">
<table>
<thead>
<tr>
<th>Period</th>
<th>Number</th>
<th>Size</th>
<th>Color</th>
<th>Result</th>
</tr>
</thead>
<tbody id="tb">
<tr><td colspan="5" class="loading">[ LOADING DATA... ]</td></tr>
</tbody>
</table>
</div>
</div>

<button class="refresh-btn" onclick="refreshData()">
<span class="refresh-icon" id="ri">‚ü≥</span>
<span>Refresh</span>
</button>

<script>
// Matrix background animation
const canvas = document.getElementById('matrix');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;
const chars = '01';
const fontSize = 14;
const cols = canvas.width / fontSize;
const drops = [];
for(let i = 0; i < cols; i++) drops[i] = 1;

function drawMatrix() {
    ctx.fillStyle = 'rgba(10,14,39,0.05)';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    ctx.fillStyle = '#00ff41';
    ctx.font = fontSize + 'px monospace';
    for(let i = 0; i < drops.length; i++) {
        const text = chars[Math.floor(Math.random() * chars.length)];
        ctx.fillText(text, i * fontSize, drops[i] * fontSize);
        if(drops[i] * fontSize > canvas.height && Math.random() > 0.975) drops[i] = 0;
        drops[i]++;
    }
}
setInterval(drawMatrix, 50);

// Game Configuration
const GAME_INTERVAL = 30; // 30 seconds game
const UPDATE_SECONDS = [29, 59]; // Update at 29 and 59 seconds

// Pattern A Configuration (Periods 01-10, 21-30, 41-50, 61-70, 81-90)
const PATTERN_A = {
    1: 'BIG',
    2: 'SMALL',
    3: 'BIG',
    4: 'BIG',
    5: 'SMALL',
    6: 'BIG',
    7: 'BIG',
    8: 'SMALL',
    9: 'BIG',
    10: 'BIG'
};

// Pattern B Configuration (Periods 11-20, 31-40, 51-60, 71-80, 91-100)
const PATTERN_B = {
    1: 'BIG',
    2: 'SMALL',
    3: 'BIG',
    4: 'BIG', // Can be BIG or SMALL
    5: 'BIG',
    6: 'SMALL',
    7: 'BIG',
    8: 'BIG',
    9: 'BIG',
    10: 'BIG'
};

// Number prediction mapping for Pattern A
const NUMBER_PRED_A = {
    0: 5, 1: 8, 2: 6, 3: 8, 4: 8,
    5: 0, 6: 7, 7: 6, 8: 0, 9: 2
};

// Number prediction mapping for Pattern B
const NUMBER_PRED_B = {
    0: 3, 1: 2, 2: 7, 3: 0, 4: 7,
    5: 1, 6: 3, 7: 8, 8: 7, 9: 7
};

// Global variables
let lastPeriod = null;
let lastPrediction = null;
let history = [];
let updateTimer = null;
let countdownTimer = null;

// Helper function to determine if number is BIG or SMALL
function getSize(num) {
    const n = parseInt(num);
    return n >= 5 ? 'BIG' : 'SMALL';
}

// Get pattern type (A or B) based on period
function getPatternType(periodStr) {
    // Extract last 2 digits
    const last2Digits = parseInt(periodStr.slice(-2));
    
    // Determine which range it falls into
    if ((last2Digits >= 1 && last2Digits <= 10) ||
        (last2Digits >= 21 && last2Digits <= 30) ||
        (last2Digits >= 41 && last2Digits <= 50) ||
        (last2Digits >= 61 && last2Digits <= 70) ||
        (last2Digits >= 81 && last2Digits <= 90)) {
        return 'A';
    } else if ((last2Digits >= 11 && last2Digits <= 20) ||
               (last2Digits >= 31 && last2Digits <= 40) ||
               (last2Digits >= 51 && last2Digits <= 60) ||
               (last2Digits >= 71 && last2Digits <= 80) ||
               (last2Digits >= 91 && last2Digits <= 100)) {
        return 'B';
    }
    return 'A'; // Default
}

// Get period position (1-10) within pattern
function getPeriodPosition(periodStr) {
    const last2Digits = parseInt(periodStr.slice(-2));
    const position = last2Digits % 10;
    return position === 0 ? 10 : position;
}

// Get pattern range display
function getPatternRange(periodStr) {
    const last2Digits = parseInt(periodStr.slice(-2));
    
    if (last2Digits >= 1 && last2Digits <= 10) return '01-10';
    if (last2Digits >= 11 && last2Digits <= 20) return '11-20';
    if (last2Digits >= 21 && last2Digits <= 30) return '21-30';
    if (last2Digits >= 31 && last2Digits <= 40) return '31-40';
    if (last2Digits >= 41 && last2Digits <= 50) return '41-50';
    if (last2Digits >= 51 && last2Digits <= 60) return '51-60';
    if (last2Digits >= 61 && last2Digits <= 70) return '61-70';
    if (last2Digits >= 71 && last2Digits <= 80) return '71-80';
    if (last2Digits >= 81 && last2Digits <= 90) return '81-90';
    if (last2Digits >= 91 && last2Digits <= 100) return '91-100';
    
    return '-';
}

// Make prediction based on patterns
function makePrediction(currentPeriod, lastResult) {
    const patternType = getPatternType(currentPeriod);
    const periodPosition = getPeriodPosition(currentPeriod);
    
    // Get pattern-based prediction
    const patternPred = patternType === 'A' ? 
        PATTERN_A[periodPosition] : 
        PATTERN_B[periodPosition];
    
    // Get number-based prediction
    const lastNum = parseInt(lastResult);
    const nextNum = patternType === 'A' ? 
        NUMBER_PRED_A[lastNum] : 
        NUMBER_PRED_B[lastNum];
    const numberPred = getSize(nextNum);
    
    // Calculate confidence
    let confidence = 65; // Base confidence from pattern
    let finalPred = patternPred;
    
    if (patternPred === numberPred) {
        confidence = 85; // Both agree
        finalPred = patternPred;
    } else {
        // They disagree, use pattern prediction but lower confidence
        confidence = 65;
        finalPred = patternPred;
    }
    
    return {
        prediction: finalPred,
        confidence: confidence,
        patternPred: patternPred,
        numberPred: numberPred,
        patternType: patternType,
        nextNum: nextNum
    };
}

// Update countdown timer
function updateCountdown() {
    const now = new Date();
    const seconds = now.getSeconds();
    
    let nextUpdate;
    if (seconds < 29) {
        nextUpdate = 29 - seconds;
    } else if (seconds < 59) {
        nextUpdate = 59 - seconds;
    } else {
        nextUpdate = 29;
    }
    
    document.getElementById('countdown').textContent = String(nextUpdate).padStart(2, '0');
    
    // Update current time
    const h = String(now.getHours()).padStart(2, '0');
    const m = String(now.getMinutes()).padStart(2, '0');
    const s = String(now.getSeconds()).padStart(2, '0');
    document.getElementById('currentTime').textContent = `${h}:${m}:${s}`;
    
    // Auto-refresh at update seconds
    if (UPDATE_SECONDS.includes(seconds)) {
        loadData();
    }
}

// Start countdown
function startCountdown() {
    updateCountdown();
    if (countdownTimer) clearInterval(countdownTimer);
    countdownTimer = setInterval(updateCountdown, 1000);
}

// Calculate streaks
function calcStreaks(arr) {
    let maxWin = 0, maxLoss = 0, currWin = 0, currLoss = 0;
    arr.forEach(e => {
        if (e.result === 'WIN') {
            currWin++;
            if (currLoss > maxLoss) maxLoss = currLoss;
            currLoss = 0;
        } else if (e.result === 'LOSS') {
            currLoss++;
            if (currWin > maxWin) maxWin = currWin;
            currWin = 0;
        }
    });
    if (currWin > maxWin) maxWin = currWin;
    if (currLoss > maxLoss) maxLoss = currLoss;
    return { maxWin, maxLoss };
}

// Get color dots for number
function getColorDots(num, color) {
    let colors = [];
    const n = parseInt(num);
    
    if (color === 'red') colors.push('red');
    else if (color === 'green') colors.push('green');
    else if (color === 'violet' || color === 'purple') colors.push('violet');
    
    if (n === 0) {
        colors.push('violet');
        colors.push('red');
    } else if (n === 5) {
        colors.push('violet');
        colors.push('green');
    }
    
    return colors;
}

// Load data from API
async function loadData() {
    try {
        const timestamp = new Date().getTime();
        const apiUrl = `https://draw.ar-lottery01.com/WinGo/WinGo_30S/GetHistoryIssuePage.json?ts=${timestamp}`;
        
        const response = await fetch(apiUrl);
        const data = await response.json();
        
        let list = [];
        if (data && data.data && data.data.list) {
            list = data.data.list.slice(0, 20);
        } else if (data && data.list) {
            list = data.list.slice(0, 20);
        } else if (Array.isArray(data)) {
            list = data.slice(0, 20);
        }
        
        const tbody = document.getElementById('tb');
        tbody.innerHTML = '';
        
        if (list.length === 0) {
            tbody.innerHTML = '<tr><td colspan="5" class="loading">[ NO DATA ]</td></tr>';
            return;
        }
        
        // Get current period and result
        const currentPeriod = String(list[0].issue || list[0].period || list[0].issueNo || '');
        const currentResult = String(list[0].result || list[0].number || list[0].num || '');
        const currentSize = getSize(currentResult);
        
        // Update pattern indicator
        const patternType = getPatternType(currentPeriod);
        const patternBox = document.getElementById('patternBox');
        const patternRange = document.getElementById('patternRange');
        
        patternBox.textContent = `PATTERN ${patternType}`;
        patternBox.className = `pattern-box pattern-${patternType.toLowerCase()}`;
        patternRange.textContent = `Period Range: ${getPatternRange(currentPeriod)}`;
        
        // Make prediction for next period
        const prediction = makePrediction(currentPeriod, currentResult);
        
        // Check if period changed and update history
        if (lastPeriod !== currentPeriod) {
            if (lastPrediction) {
                const isMatch = lastPrediction.prediction === currentSize;
                const record = {
                    period: currentPeriod,
                    predicted: lastPrediction.prediction,
                    actual: currentSize,
                    result: isMatch ? 'WIN' : 'LOSS',
                    number: currentResult
                };
                history.unshift(record);
                if (history.length > 100) history = history.slice(0, 100);
            }
            lastPrediction = prediction;
            lastPeriod = currentPeriod;
        }
        
        // Update prediction display
        const predElem = document.getElementById('currPred');
        predElem.innerHTML = `<span class="prediction-${prediction.prediction.toLowerCase()}">${prediction.prediction}</span>`;
        
        const confBar = document.getElementById('confBar');
        const confLabel = document.getElementById('confLabel');
        confBar.style.width = prediction.confidence + '%';
        
        if (prediction.confidence >= 80) {
            confLabel.innerHTML = '<span class="confidence-high">HIGH CONFIDENCE (' + prediction.confidence + '%)</span>';
        } else if (prediction.confidence >= 70) {
            confLabel.innerHTML = '<span class="confidence-medium">MEDIUM CONFIDENCE (' + prediction.confidence + '%)</span>';
        } else {
            confLabel.innerHTML = '<span class="confidence-low">LOW CONFIDENCE (' + prediction.confidence + '%)</span>';
        }
        
        // Update prediction details
        document.getElementById('patternPred').textContent = prediction.patternPred;
        document.getElementById('numberPred').textContent = prediction.numberPred;
        
        // Calculate stats
        let winCount = 0, lossCount = 0;
        history.forEach(e => {
            if (e.result === 'WIN') winCount++;
            if (e.result === 'LOSS') lossCount++;
        });
        
        const streaks = calcStreaks(history);
        const total = winCount + lossCount;
        const winRate = total > 0 ? Math.round((winCount / total) * 100) : 0;
        
        document.getElementById('wc').textContent = winCount;
        document.getElementById('lc').textContent = lossCount;
        document.getElementById('tc').textContent = total;
        document.getElementById('wr').textContent = winRate + '%';
        document.getElementById('mw').textContent = streaks.maxWin;
        document.getElementById('ml').textContent = streaks.maxLoss;
        
        // Populate table
        list.forEach((item, index) => {
            const tr = document.createElement('tr');
            
            // Period
            const tdPeriod = document.createElement('td');
            tdPeriod.className = 'period-cell';
            const periodValue = String(item.issue || item.period || item.issueNo || '');
            tdPeriod.textContent = periodValue || 'N/A';
            
            // Number
            const resultNum = item.result || item.number || item.num || '?';
            const tdNumber = document.createElement('td');
            tdNumber.className = 'number-cell';
            const numSpan = document.createElement('span');
            const colorValue = (item.color || item.colour || '').toLowerCase();
            
            if (colorValue === 'red') {
                numSpan.style.color = '#ff0055';
                numSpan.style.textShadow = '0 0 10px #ff0055';
            } else if (colorValue === 'green') {
                numSpan.style.color = '#00ff41';
                numSpan.style.textShadow = '0 0 10px #00ff41';
            } else if (colorValue === 'violet' || colorValue === 'purple') {
                numSpan.style.color = '#aa00ff';
                numSpan.style.textShadow = '0 0 10px #aa00ff';
            }
            numSpan.textContent = resultNum;
            tdNumber.appendChild(numSpan);
            
            // Size
            const tdSize = document.createElement('td');
            tdSize.className = 'size-cell';
            const sizeValue = getSize(resultNum);
            tdSize.textContent = sizeValue;
            tdSize.classList.add(sizeValue === 'BIG' ? 'size-big' : 'size-small');
            
            // Color
            const tdColor = document.createElement('td');
            tdColor.className = 'color-cell';
            const colorDots = getColorDots(parseInt(resultNum), colorValue);
            colorDots.forEach(c => {
                const dot = document.createElement('span');
                dot.className = `color-dot ${c}`;
                tdColor.appendChild(dot);
            });
            
            // Result
            const tdResult = document.createElement('td');
            const matchRecord = history.find(h => String(h.period) === String(periodValue));
            if (matchRecord) {
                if (matchRecord.result === 'WIN') {
                    tdResult.className = 'result-cell result-win';
                    tdResult.textContent = '‚úì WIN';
                } else {
                    tdResult.className = 'result-cell result-loss';
                    tdResult.textContent = '‚úó LOSS';
                }
            } else {
                tdResult.textContent = '-';
            }
            
            tr.appendChild(tdPeriod);
            tr.appendChild(tdNumber);
            tr.appendChild(tdSize);
            tr.appendChild(tdColor);
            tr.appendChild(tdResult);
            tbody.appendChild(tr);
        });
        
    } catch (error) {
        console.error('Error loading data:', error);
        document.getElementById('tb').innerHTML = '<tr><td colspan="5" class="loading">[ ERROR LOADING DATA ]</td></tr>';
    }
}

// Refresh button handler
function refreshData() {
    const icon = document.getElementById('ri');
    icon.classList.add('spinning');
    setTimeout(() => icon.classList.remove('spinning'), 500);
    loadData();
}

// Initialize
loadData();
startCountdown();
</script>
</body>
</html>

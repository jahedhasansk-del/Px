<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Pattern Slot System - 50 Entry Analysis</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Courier New',monospace;background:#0a0e27;min-height:100vh;padding:20px;position:relative;overflow-x:hidden}
body::before{content:'';position:fixed;top:0;left:0;right:0;bottom:0;background:linear-gradient(0deg,transparent 0%,rgba(0,255,65,.03) 50%,transparent 100%);pointer-events:none;animation:scan 8s linear infinite;z-index:0}
@keyframes scan{0%{transform:translateY(-100%)}100%{transform:translateY(100%)}}
.container{max-width:900px;margin:0 auto;position:relative;z-index:1}
h1{color:#00ff41;text-align:center;margin-bottom:30px;font-size:2.5em;text-shadow:0 0 10px #00ff41,0 0 20px #00ff41,0 0 30px #00ff41;animation:glitch 3s infinite;letter-spacing:3px}
@keyframes glitch{0%,100%{text-shadow:0 0 10px #00ff41,0 0 20px #00ff41}25%{text-shadow:2px 0 10px #ff0000,-2px 0 10px #00ff41}50%{text-shadow:-2px 0 10px #0000ff,2px 0 10px #00ff41}75%{text-shadow:0 0 10px #00ff41,0 0 20px #00ff41}}
.win-loss-box{background:rgba(0,255,65,.05);border:2px solid #00ff41;border-radius:10px;padding:20px;margin-bottom:25px;box-shadow:0 0 20px rgba(0,255,65,.3);position:relative}
.win-loss-box::before{content:'';position:absolute;top:-2px;left:-2px;right:-2px;bottom:-2px;background:linear-gradient(90deg,#00ff41,#00aaff,#00ff41);border-radius:10px;z-index:-1;opacity:.3;animation:borderFlow 3s linear infinite}
@keyframes borderFlow{0%{background-position:0% 50%}100%{background-position:200% 50%}}
.win-loss-grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:15px}
.wl-item{border:1px solid;border-radius:8px;padding:15px;text-align:center;position:relative;overflow:hidden}
.wl-item::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.1),transparent);animation:shimmer 3s infinite}
@keyframes shimmer{0%{left:-100%}100%{left:100%}}
.wl-item.win{background:rgba(16,185,129,.1);border-color:#10b981;color:#10b981}
.wl-item.loss{background:rgba(239,68,68,.1);border-color:#ef4444;color:#ef4444}
.wl-item.rate{background:rgba(251,191,36,.1);border-color:#fbbf24;color:#fbbf24}
.wl-label{font-size:.85em;opacity:.8;margin-bottom:5px;letter-spacing:1px}
.wl-value{font-size:2em;font-weight:bold;text-shadow:0 0 10px currentColor}
.slots-container{background:rgba(0,255,65,.05);border:2px solid #00ff41;border-radius:10px;padding:25px;margin-bottom:25px;box-shadow:0 0 20px rgba(0,255,65,.3)}
.slots-info{color:#00ff41;text-align:center;margin-bottom:15px;font-size:.9em;letter-spacing:1px}
.slots-grid{display:grid;grid-template-columns:repeat(10,1fr);gap:10px;margin-bottom:20px}
.slot{aspect-ratio:1;border-radius:8px;display:flex;align-items:center;justify-content:center;font-weight:bold;font-size:1.2em;transition:all .3s ease;position:relative}
.slot.empty{background:rgba(0,255,65,.05);border:1px solid rgba(0,255,65,.3)}
.slot.big{background:rgba(16,185,129,.2);border:2px solid #10b981;color:#10b981;box-shadow:0 0 15px rgba(16,185,129,.5);animation:pulse 2s infinite}
.slot.small{background:rgba(239,68,68,.2);border:2px solid #ef4444;color:#ef4444;box-shadow:0 0 15px rgba(239,68,68,.5);animation:pulse 2s infinite}
@keyframes pulse{0%,100%{box-shadow:0 0 15px currentColor}50%{box-shadow:0 0 25px currentColor}}
.total-info{text-align:center;color:#00ff41;font-size:.9em;letter-spacing:1px}
.button-grid{display:grid;grid-template-columns:1fr 1fr;gap:15px;margin-bottom:20px}
button{padding:20px;font-size:1.5em;font-weight:bold;border:2px solid;border-radius:10px;cursor:pointer;transition:all .3s ease;text-transform:uppercase;letter-spacing:2px;position:relative;overflow:hidden}
button::before{content:'';position:absolute;top:50%;left:50%;width:0;height:0;border-radius:50%;background:rgba(255,255,255,.3);transform:translate(-50%,-50%);transition:width .6s,height .6s}
button:hover::before{width:300px;height:300px}
button:active{transform:scale(.95)}
button:disabled{opacity:.3;cursor:not-allowed}
.btn-big{background:rgba(16,185,129,.1);color:#10b981;border-color:#10b981}
.btn-big:hover{background:rgba(16,185,129,.2);box-shadow:0 0 20px rgba(16,185,129,.5)}
.btn-small{background:rgba(239,68,68,.1);color:#ef4444;border-color:#ef4444}
.btn-small:hover{background:rgba(239,68,68,.2);box-shadow:0 0 20px rgba(239,68,68,.5)}
.btn-big.predicted{animation:glowGreen 1s infinite;border-width:3px}
.btn-small.predicted{animation:glowRed 1s infinite;border-width:3px}
@keyframes glowGreen{0%,100%{box-shadow:0 0 20px #10b981,0 0 40px #10b981,inset 0 0 20px rgba(16,185,129,.3)}50%{box-shadow:0 0 30px #10b981,0 0 60px #10b981,inset 0 0 30px rgba(16,185,129,.5)}}
@keyframes glowRed{0%,100%{box-shadow:0 0 20px #ef4444,0 0 40px #ef4444,inset 0 0 20px rgba(239,68,68,.3)}50%{box-shadow:0 0 30px #ef4444,0 0 60px #ef4444,inset 0 0 30px rgba(239,68,68,.5)}}
.btn-predict{background:rgba(251,191,36,.1);color:#fbbf24;border-color:#fbbf24;grid-column:1/-1;display:flex;align-items:center;justify-content:center;gap:10px;font-size:1.2em}
.btn-predict:hover{background:rgba(251,191,36,.2);box-shadow:0 0 20px rgba(251,191,36,.5)}
.action-buttons{display:grid;grid-template-columns:1fr 1fr;gap:15px;margin-bottom:25px}
.btn-undo{background:rgba(234,179,8,.1);color:#eab308;border-color:#eab308;padding:15px;font-size:1em}
.btn-undo:hover{background:rgba(234,179,8,.2);box-shadow:0 0 20px rgba(234,179,8,.5)}
.btn-clear{background:rgba(168,85,247,.1);color:#a855f7;border-color:#a855f7;padding:15px;font-size:1em;display:flex;align-items:center;justify-content:center;gap:8px}
.btn-clear:hover{background:rgba(168,85,247,.2);box-shadow:0 0 20px rgba(168,85,247,.5)}
.prediction-box{background:rgba(0,255,65,.05);border:2px solid #00ff41;border-radius:10px;padding:25px;margin-bottom:25px;display:none;box-shadow:0 0 20px rgba(0,255,65,.3)}
.prediction-box.show{display:block;animation:fadeIn .5s ease}
@keyframes fadeIn{from{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}
.prediction-title{color:#00ff41;text-align:center;font-size:1.3em;margin-bottom:10px;text-shadow:0 0 10px #00ff41;letter-spacing:2px}
.prediction-legend{background:rgba(59,130,246,.1);border:1px solid #3b82f6;border-radius:8px;padding:12px;margin-bottom:15px;color:#3b82f6;text-align:center;font-size:.9em;letter-spacing:1px}
.block-info{background:rgba(0,255,65,.1);border:1px solid #00ff41;border-radius:8px;padding:12px;margin-bottom:15px;color:#00ff41;text-align:center;font-size:.9em;letter-spacing:1px}
.prediction-result{border:2px solid;border-radius:10px;padding:30px;text-align:center;margin-bottom:15px;animation:resultPulse 2s infinite;position:relative;overflow:hidden}
.prediction-result::before{content:'';position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:conic-gradient(transparent,rgba(255,255,255,.1),transparent 30%);animation:rotate 4s linear infinite}
@keyframes rotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
@keyframes resultPulse{0%,100%{transform:scale(1)}50%{transform:scale(1.02)}}
.prediction-result.big{background:rgba(16,185,129,.1);border-color:#10b981}
.prediction-result.small{background:rgba(239,68,68,.1);border-color:#ef4444}
.prediction-value{font-size:3.5em;font-weight:bold;margin-bottom:10px;position:relative;z-index:1}
.prediction-result.big .prediction-value{color:#10b981;text-shadow:0 0 20px #10b981}
.prediction-result.small .prediction-value{color:#ef4444;text-shadow:0 0 20px #ef4444}
.prediction-confidence{color:#00ff41;font-size:.9em;position:relative;z-index:1;letter-spacing:1px}
.prediction-reason{background:rgba(0,255,65,.1);border:1px solid #00ff41;border-radius:8px;padding:15px;color:#00ff41;text-align:center;margin-bottom:15px}
.prediction-reason-label{font-size:.85em;opacity:.8;margin-bottom:5px;letter-spacing:1px}
.prediction-reason-text{font-weight:600;letter-spacing:1px}
.summary-box{background:rgba(0,255,65,.05);border:2px solid #00ff41;border-radius:10px;padding:25px;margin-bottom:25px;box-shadow:0 0 20px rgba(0,255,65,.3)}
.summary-title{color:#00ff41;font-size:1.3em;margin-bottom:20px;text-shadow:0 0 10px #00ff41;letter-spacing:2px}
.summary-grid{display:grid;grid-template-columns:1fr 1fr;gap:15px;margin-bottom:20px}
.summary-item{border:2px solid;border-radius:10px;padding:20px;text-align:center;position:relative;overflow:hidden}
.summary-item::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(45deg,transparent,rgba(255,255,255,.05),transparent);animation:shimmer 3s infinite}
.summary-item.big{background:rgba(16,185,129,.1);border-color:#10b981}
.summary-item.small{background:rgba(239,68,68,.1);border-color:#ef4444}
.summary-label{color:#00ff41;font-size:.9em;margin-bottom:5px;opacity:.8;letter-spacing:1px}
.summary-value{font-size:2.5em;font-weight:bold;position:relative;z-index:1}
.summary-item.big .summary-value{color:#10b981;text-shadow:0 0 15px #10b981}
.summary-item.small .summary-value{color:#ef4444;text-shadow:0 0 15px #ef4444}
.last11-stats{background:rgba(0,255,65,.1);border:1px solid #00ff41;border-radius:10px;padding:15px;color:#00ff41}
.last11-label{font-size:.85em;opacity:.8;margin-bottom:10px;letter-spacing:1px}
.last11-values{display:flex;justify-content:space-around;font-size:1.1em;letter-spacing:1px}
.analysis-stats{background:rgba(59,130,246,.1);border:1px solid #3b82f6;border-radius:10px;padding:15px;margin-bottom:15px;color:#3b82f6}
.analysis-title{font-size:1.1em;font-weight:bold;margin-bottom:10px;text-align:center;letter-spacing:1px}
.analysis-grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin-top:10px}
.analysis-box{background:rgba(0,255,65,.1);border:1px solid #00ff41;border-radius:6px;padding:10px;text-align:center}
.analysis-label{font-size:.8em;color:#00ff41;opacity:.8;margin-bottom:5px}
.analysis-value{font-size:1.3em;font-weight:bold;color:#00ff41}
.history-box{background:rgba(0,255,65,.05);border:2px solid #00ff41;border-radius:10px;padding:20px;box-shadow:0 0 20px rgba(0,255,65,.3);margin-top:25px}
.history-title{color:#00ff41;font-size:1.2em;margin-bottom:15px;text-align:center;text-shadow:0 0 10px #00ff41;letter-spacing:2px}
.history-grid{display:grid;gap:8px;max-height:300px;overflow-y:auto}
.history-grid::-webkit-scrollbar{width:8px}
.history-grid::-webkit-scrollbar-track{background:rgba(0,255,65,.1);border-radius:4px}
.history-grid::-webkit-scrollbar-thumb{background:#00ff41;border-radius:4px}
.history-item{display:grid;grid-template-columns:60px 120px 120px 120px 1fr;gap:10px;padding:12px;background:rgba(0,255,65,.05);border:1px solid rgba(0,255,65,.3);border-radius:6px;font-size:.9em;align-items:center;transition:all .3s ease}
.history-item:hover{background:rgba(0,255,65,.1);border-color:#00ff41;box-shadow:0 0 15px rgba(0,255,65,.3)}
.history-item.success{border-left:4px solid #10b981;background:rgba(16,185,129,.05)}
.history-item.failed{border-left:4px solid #ef4444;background:rgba(239,68,68,.05)}
.history-index{color:#00ff41;font-weight:bold;text-align:center;letter-spacing:1px}
.history-predicted{text-align:center;font-weight:bold;letter-spacing:1px;padding:5px 10px;border-radius:6px}
.history-predicted.big{color:#10b981;background:rgba(16,185,129,.2);border:1px solid #10b981}
.history-predicted.small{color:#ef4444;background:rgba(239,68,68,.2);border:1px solid #ef4444}
.history-actual{text-align:center;font-weight:bold;letter-spacing:1px;padding:5px 10px;border-radius:6px}
.history-actual.big{color:#10b981;background:rgba(16,185,129,.15);border:1px solid #10b981}
.history-actual.small{color:#ef4444;background:rgba(239,68,68,.15);border:1px solid #ef4444}
.history-result{text-align:center;font-weight:bold;font-size:1.1em;letter-spacing:1px}
.history-result.success{color:#10b981;text-shadow:0 0 10px #10b981}
.history-result.failed{color:#ef4444;text-shadow:0 0 10px #ef4444}
.history-time{color:#00ff41;text-align:right;font-size:.85em;opacity:.8;letter-spacing:1px}
@media(max-width:768px){
.win-loss-grid{grid-template-columns:1fr 1fr 1fr;gap:10px}
.wl-value{font-size:1.5em}
.slots-grid{gap:5px}
.slot{font-size:1em}
button{padding:15px;font-size:1.2em}
.prediction-value{font-size:2.5em}
.analysis-grid{grid-template-columns:1fr 1fr;gap:8px}
.history-item{grid-template-columns:50px 90px 90px 80px 60px;font-size:.8em;padding:8px;gap:6px}
}
</style>
</head>
<body>
<div class="container">
<h1>PATTERN SLOT SYSTEM</h1>
<div class="win-loss-box">
<div class="win-loss-grid">
<div class="wl-item win">
<div class="wl-label">‚úÖ WIN</div>
<div class="wl-value" id="winCount">0</div>
</div>
<div class="wl-item loss">
<div class="wl-label">‚ùå LOSS</div>
<div class="wl-value" id="lossCount">0</div>
</div>
<div class="wl-item rate">
<div class="wl-label">üìä WIN RATE</div>
<div class="wl-value" id="winRate">0%</div>
</div>
</div>
</div>
<div class="slots-container">
<div class="slots-info">Last 20 Shown (Total: <span id="totalCount">0</span>)</div>
<div class="slots-grid" id="slotsGrid"></div>
<div class="total-info">Total Entries: <span id="totalEntries">0</span></div>
</div>
<div class="button-grid">
<button class="btn-big" id="bigBtn" onclick="addPattern('BIG')">BIG</button>
<button class="btn-small" id="smallBtn" onclick="addPattern('SMALL')">SMALL</button>
</div>
<button class="btn-predict" id="predictBtn" onclick="togglePrediction()" disabled>
<span>üî¨</span>
<span id="predictBtnText">AI Prediction (Need 50)</span>
</button>
<div class="prediction-box" id="predictionBox"></div>
<div class="action-buttons">
<button class="btn-undo" onclick="removeLastPattern()" id="undoBtn" disabled>Undo Last</button>
<button class="btn-clear" onclick="clearAll()"><span>üóëÔ∏è</span><span>Clear All</span></button>
</div>
<div class="summary-box" id="summaryBox" style="display:none">
<h2 class="summary-title">PATTERN SUMMARY</h2>
<div class="summary-grid">
<div class="summary-item big">
<div class="summary-label">BIG</div>
<div class="summary-value" id="bigCount">0</div>
</div>
<div class="summary-item small">
<div class="summary-label">SMALL</div>
<div class="summary-value" id="smallCount">0</div>
</div>
</div>
<div class="last11-stats" id="last11Stats" style="display:none">
<div class="last11-label">Last 11 (Set #11):</div>
<div class="last11-values">
<div>BIG: <span id="last11Big">0</span></div>
<div>SMALL: <span id="last11Small">0</span></div>
</div>
</div>
</div>
<div class="history-box">
<h2 class="history-title">üéØ PREDICTION HISTORY</h2>
<div class="history-grid" id="historyGrid"></div>
</div>
</div>
let slots = [];
let showPrediction = false;
let currentPrediction = null;
let winCount = 0;
let lossCount = 0;
let predictionHistory = [];

function updateWinLoss() {
    document.getElementById("winCount").textContent = winCount;
    document.getElementById("lossCount").textContent = lossCount;
    const total = winCount + lossCount;
    const rate = total > 0 ? Math.round(winCount / total * 100) : 0;
    document.getElementById("winRate").textContent = rate + "%";
}

function renderSlots() {
    const grid = document.getElementById("slotsGrid");
    const lastSlots = slots.slice(-20);
    const emptyCount = Math.max(0, 20 - lastSlots.length);
    
    grid.innerHTML = "";
    
    for (let i = 0; i < emptyCount; i++) {
        const slot = document.createElement("div");
        slot.className = "slot empty";
        grid.appendChild(slot);
    }
    
    lastSlots.forEach(type => {
        const slot = document.createElement("div");
        slot.className = `slot ${type.toLowerCase()}`;
        slot.textContent = type === "BIG" ? "B" : "S";
        grid.appendChild(slot);
    });
    
    document.getElementById("totalCount").textContent = slots.length;
    document.getElementById("totalEntries").textContent = slots.length;
    document.getElementById("predictBtn").disabled = slots.length < 50;
    document.getElementById("undoBtn").disabled = slots.length === 0;
    
    updateSummary();
    renderHistory();
}

function renderHistory() {
    const historyGrid = document.getElementById("historyGrid");
    
    if (predictionHistory.length === 0) {
        historyGrid.innerHTML = '<div style="text-align:center;color:#00ff41;opacity:0.6;padding:20px;letter-spacing:1px">No prediction records yet</div>';
        return;
    }
    
    const historyHTML = [...predictionHistory].reverse().map((record, index) => {
        const recordNum = predictionHistory.length - index;
        const resultClass = record.success ? "success" : "failed";
        const resultText = record.success ? "‚úÖ SUCCESS" : "‚ùå FAILED";
        
        return `<div class="history-item ${resultClass}">
            <div class="history-index">#${recordNum}</div>
            <div class="history-predicted ${record.predicted.toLowerCase()}">${record.predicted}</div>
            <div class="history-actual ${record.actual.toLowerCase()}">${record.actual}</div>
            <div class="history-result ${resultClass}">${resultText}</div>
            <div class="history-time">${record.time}</div>
        </div>`;
    }).join("");
    
    historyGrid.innerHTML = historyHTML;
}

function updateSummary() {
    const summaryBox = document.getElementById("summaryBox");
    
    if (slots.length > 0) {
        summaryBox.style.display = "block";
        
        const bigCount = slots.filter(s => s === "BIG").length;
        const smallCount = slots.filter(s => s === "SMALL").length;
        
        document.getElementById("bigCount").textContent = bigCount;
        document.getElementById("smallCount").textContent = smallCount;
        
        if (slots.length >= 11) {
            const last11 = slots.slice(-11);
            const last11Big = last11.filter(s => s === "BIG").length;
            const last11Small = last11.filter(s => s === "SMALL").length;
            
            document.getElementById("last11Stats").style.display = "block";
            document.getElementById("last11Big").textContent = last11Big;
            document.getElementById("last11Small").textContent = last11Small;
        } else {
            document.getElementById("last11Stats").style.display = "none";
        }
    } else {
        summaryBox.style.display = "none";
    }
}

function highlightPrediction(prediction) {
    document.getElementById("bigBtn").classList.remove("predicted");
    document.getElementById("smallBtn").classList.remove("predicted");
    
    if (prediction) {
        if (prediction === "BIG") {
            document.getElementById("bigBtn").classList.add("predicted");
        } else {
            document.getElementById("smallBtn").classList.add("predicted");
        }
    }
}

function addPattern(type) {
    if (currentPrediction) {
        const success = type === currentPrediction;
        const now = new Date();
        const time = String(now.getHours()).padStart(2, "0") + ":" + String(now.getMinutes()).padStart(2, "0");
        
        predictionHistory.push({
            predicted: currentPrediction,
            actual: type,
            success: success,
            time: time
        });
        
        if (success) {
            winCount++;
        } else {
            lossCount++;
        }
        
        updateWinLoss();
        currentPrediction = null;
        highlightPrediction(null);
    }
    
    slots.push(type);
    renderSlots();
    
    if (showPrediction) {
        showPredictionResult();
    }
}

function removeLastPattern() {
    if (slots.length > 0) {
        slots.pop();
        
        if (currentPrediction) {
            currentPrediction = null;
            highlightPrediction(null);
        }
        
        renderSlots();
        
        if (showPrediction) {
            if (slots.length >= 50) {
                showPredictionResult();
            } else {
                showPrediction = false;
                document.getElementById("predictionBox").classList.remove("show");
                document.getElementById("predictBtnText").textContent = "AI Prediction (Need 50)";
            }
        }
    }
}

function clearAll() {
    slots = [];
    showPrediction = false;
    currentPrediction = null;
    winCount = 0;
    lossCount = 0;
    predictionHistory = [];
    
    updateWinLoss();
    highlightPrediction(null);
    renderSlots();
    
    document.getElementById("predictionBox").classList.remove("show");
    document.getElementById("predictBtnText").textContent = "AI Prediction (Need 50)";
}

function analyzePrediction() {
    if (slots.length < 50) {
        return {
            prediction: null,
            confidence: 0,
            reason: "Need at least 50 entries for AI analysis"
        };
    }
    
    const last50 = slots.slice(-50);
    
    let bigCount = 0;
    let smallCount = 0;
    for (let i = 0; i < last50.length; i++) {
        if (last50[i] === "BIG") {
            bigCount++;
        } else {
            smallCount++;
        }
    }
    
    const dominantType = bigCount > smallCount ? "BIG" : "SMALL";
    const imbalance = Math.abs(bigCount - smallCount);
    
    const recent25 = last50.slice(-25);
    const previous25 = last50.slice(-50, -25);
    
    let followCount = 0;
    for (let i = 0; i < 25; i++) {
        if (recent25[i] === previous25[i]) {
            followCount++;
        }
    }
    
    const oppositeCount = 25 - followCount;
    
    const repetitions = [];
    for (let i = 0; i < last50.length - 1; i++) {
        if (last50[i] === last50[i + 1]) {
            repetitions.push(i);
        }
    }
    const repetitionCount = repetitions.length;
    
    const streaks = [];
    let currentStreak = 1;
    let currentType = last50[0];
    
    for (let i = 1; i < last50.length; i++) {
        if (last50[i] === currentType) {
            currentStreak++;
        } else {
            if (currentStreak >= 3) {
                streaks.push({
                    type: currentType,
                    count: currentStreak,
                    position: i - currentStreak
                });
            }
            currentStreak = 1;
            currentType = last50[i];
        }
    }
    
    if (currentStreak >= 3) {
        streaks.push({
            type: currentType,
            count: currentStreak,
            position: last50.length - currentStreak
        });
    }
    
    const maxStreak = streaks.length > 0 ? Math.max(...streaks.map(s => s.count)) : 0;
    const lastStreak = streaks.length > 0 ? streaks[streaks.length - 1] : null;
    
    const last20 = last50.slice(-20);
    let patterns = [];
    for (let i = 1; i < last20.length; i++) {
        patterns.push(last20[i] === last20[i - 1] ? "Same" : "Opp");
    }
    
    const blocks = [];
    let currentBlock = {
        type: patterns[0],
        count: 1,
        values: [last20[0]]
    };
    
    for (let i = 1; i < patterns.length; i++) {
        if (patterns[i] === currentBlock.type) {
            currentBlock.count++;
            currentBlock.values.push(last20[i]);
        } else {
            blocks.push({...currentBlock});
            currentBlock = {
                type: patterns[i],
                count: 1,
                values: [last20[i]]
            };
        }
    }
    
    currentBlock.values.push(last20[last20.length - 1]);
    blocks.push(currentBlock);
    
    const lastBlock = blocks[blocks.length - 1];
    const lastValue = last50[last50.length - 1];
    
    const blockInfo = blocks.map(b => `${b.count}${b.type === "Same" ? "‚úì" : "‚Üî"}`).join(" ‚Üí ");
    
    let prediction, confidence, reason;
    
    if (lastStreak && lastStreak.count >= 5 && last50.length - lastStreak.position - lastStreak.count <= 2) {
        prediction = lastStreak.type === "BIG" ? "SMALL" : "BIG";
        confidence = 94;
        reason = `üî• MEGA STREAK BREAK (${lastStreak.count}x ${lastStreak.type}) - Extreme Reverse!`;
    } else if (maxStreak >= 4 && lastStreak && last50.length - lastStreak.position - lastStreak.count <= 3) {
        prediction = lastStreak.type === "BIG" ? "SMALL" : "BIG";
        confidence = 91;
        reason = `‚ö° Long Streak Detected (${maxStreak}x) - Strong Break Signal`;
    } else if (blocks.length >= 4 && blocks.slice(-4).every(b => b.count === 1)) {
        const blockType = lastBlock.type;
        prediction = blockType === "Opp" ? (lastValue === "BIG" ? "SMALL" : "BIG") : lastValue;
        confidence = 89;
        reason = "üéØ Perfect Zigzag (1-1-1-1) - Ultra Pattern";
    } else if (blocks.length >= 3 && blocks.slice(-3).every(b => b.count === 1)) {
        const blockType = lastBlock.type;
        prediction = blockType === "Opp" ? (lastValue === "BIG" ? "SMALL" : "BIG") : lastValue;
        confidence = 86;
        reason = "üîÑ Triple Zigzag (1-1-1) - Strong Pattern";
    } else if (lastBlock.count === 3) {
        prediction = lastBlock.type === "Same" ? (lastValue === "BIG" ? "SMALL" : "BIG") : lastValue;
        confidence = 84;
        reason = `üéØ Triple Block (${lastBlock.count}${lastBlock.type === "Same" ? "‚úì" : "‚Üî"}) - Reverse Coming`;
    } else if (lastBlock.count === 4) {
        prediction = lastBlock.type === "Same" ? (lastValue === "BIG" ? "SMALL" : "BIG") : lastValue;
        confidence = 88;
        reason = `‚ö° Quad Block (${lastBlock.count}${lastBlock.type === "Same" ? "‚úì" : "‚Üî"}) - Strong Reverse`;
    } else if (lastBlock.count >= 5) {
        prediction = lastValue === "BIG" ? "SMALL" : "BIG";
        confidence = 92;
        reason = `üî• Massive Block (${lastBlock.count}${lastBlock.type === "Same" ? "‚úì" : "‚Üî"}) - Critical Reverse`;
    } else if (lastBlock.count === 2) {
        prediction = lastBlock.type === "Opp" ? (lastValue === "BIG" ? "SMALL" : "BIG") : lastValue;
        confidence = 81;
        reason = `üìä Double Pattern (${lastBlock.count}${lastBlock.type === "Same" ? "‚úì" : "‚Üî"}) - Change Expected`;
    } else if (imbalance >= 20) {
        prediction = dominantType;
        confidence = 83;
        reason = `‚öñÔ∏è Huge Imbalance (${bigCount}B/${smallCount}S) - Follow ${dominantType}`;
    } else if (imbalance >= 15) {
        prediction = dominantType;
        confidence = 79;
        reason = `‚öñÔ∏è Big Imbalance (${bigCount}B/${smallCount}S) - Lean ${dominantType}`;
    } else if (followCount >= 20) {
        prediction = previous25[0];
        confidence = 82;
        reason = `‚úÖ Super Follow Rate (${followCount}/25) - History Strong`;
    } else if (oppositeCount >= 20) {
        prediction = previous25[0] === "BIG" ? "SMALL" : "BIG";
        confidence = 82;
        reason = `‚ùå Super Opposite (${oppositeCount}/25) - Reverse Strong`;
    } else if (repetitionCount >= 30) {
        prediction = lastValue;
        confidence = 78;
        reason = `üîÅ High Repetition (${repetitionCount}/49) - Continue Trend`;
    } else if (followCount >= 18) {
        prediction = previous25[0];
        confidence = 77;
        reason = `‚úÖ High Follow (${followCount}/25) - History Pattern`;
    } else if (oppositeCount >= 18) {
        prediction = previous25[0] === "BIG" ? "SMALL" : "BIG";
        confidence = 77;
        reason = `‚ùå High Opposite (${oppositeCount}/25) - Reverse Pattern`;
    } else if (blocks.length >= 2) {
        const prevBlock = blocks[blocks.length - 2];
        if (prevBlock.count >= 3 && lastBlock.count === 1) {
            prediction = lastBlock.type === "Opp" ? (lastValue === "BIG" ? "SMALL" : "BIG") : lastValue;
            confidence = 76;
            reason = `üîÄ After Streak (${prevBlock.count}‚Üí1) - Mix Pattern`;
        } else {
            prediction = lastBlock.type === "Opp" ? (lastValue === "BIG" ? "SMALL" : "BIG") : lastValue;
            confidence = 72;
            reason = "üîÑ Standard Pattern Flow";
        }
    } else {
        prediction = lastBlock.type === "Opp" ? (lastValue === "BIG" ? "SMALL" : "BIG") : lastValue;
        confidence = 68;
        reason = "üé≤ Basic Pattern Following";
    }
    
    return {
        prediction: prediction,
        confidence: confidence,
        reason: reason,
        blockInfo: blockInfo,
        advancedStats: {
            totalEntries: 50,
            bigCount: bigCount,
            smallCount: smallCount,
            dominantType: dominantType,
            imbalance: imbalance,
            followRate: followCount,
            oppositeRate: oppositeCount,
            repetitionCount: repetitionCount,
            maxStreak: maxStreak,
            lastStreak: lastStreak,
            recentBlocks: blocks.slice(-5)
        }
    };
}

function showPredictionResult() {
    const analysis = analyzePrediction();
    const box = document.getElementById("predictionBox");
    
    if (analysis.prediction) {
        currentPrediction = analysis.prediction;
        highlightPrediction(analysis.prediction);
        
        let statsHTML = "";
        if (analysis.advancedStats) {
            const {
                totalEntries,
                bigCount,
                smallCount,
                dominantType,
                imbalance,
                followRate,
                oppositeRate,
                repetitionCount,
                maxStreak,
                lastStreak
            } = analysis.advancedStats;
            
            statsHTML = `<div class="analysis-stats">
                <div class="analysis-title">üî¨ 50-ENTRY DEEP AI ANALYSIS</div>
                <div class="analysis-grid">
                    <div class="analysis-box"><div class="analysis-label">Total Data</div><div class="analysis-value">${totalEntries}</div></div>
                    <div class="analysis-box"><div class="analysis-label">BIG</div><div class="analysis-value">${bigCount}</div></div>
                    <div class="analysis-box"><div class="analysis-label">SMALL</div><div class="analysis-value">${smallCount}</div></div>
                    <div class="analysis-box"><div class="analysis-label">Dominant</div><div class="analysis-value">${dominantType}</div></div>
                    <div class="analysis-box"><div class="analysis-label">Imbalance</div><div class="analysis-value">${imbalance}</div></div>
                    <div class="analysis-box"><div class="analysis-label">Max Streak</div><div class="analysis-value">${maxStreak}</div></div>
                    <div class="analysis-box"><div class="analysis-label">Follow Rate</div><div class="analysis-value">${followRate}/25</div></div>
                    <div class="analysis-box"><div class="analysis-label">Opposite</div><div class="analysis-value">${oppositeRate}/25</div></div>
                    <div class="analysis-box"><div class="analysis-label">Repetitions</div><div class="analysis-value">${repetitionCount}</div></div>
                </div>
                ${lastStreak ? `<div style="margin-top:15px;background:rgba(251,191,36,0.1);border:1px solid #fbbf24;border-radius:8px;padding:12px;text-align:center;color:#fbbf24;font-weight:bold">‚ö†Ô∏è Active Streak: ${lastStreak.count}x ${lastStreak.type} (Position: ${lastStreak.position})</div>` : ""}
            </div>`;
        }
        
        box.innerHTML = `
            <h2 class="prediction-title">üéØ AI PATTERN PREDICTION</h2>
            <div class="prediction-legend">‚úì = Same | ‚Üî = Opposite | 50 Entries Analysis</div>
            ${analysis.blockInfo ? `<div class="block-info">Last 20 Pattern: ${analysis.blockInfo}</div>` : ""}
            ${statsHTML}
            <div class="prediction-result ${analysis.prediction.toLowerCase()}">
                <div class="prediction-value">${analysis.prediction}</div>
                <div class="prediction-confidence">AI Confidence: ${analysis.confidence}%</div>
            </div>
            <div class="prediction-reason">
                <div class="prediction-reason-label">ü§ñ AI Analysis:</div>
                <div class="prediction-reason-text">${analysis.reason}</div>
            </div>
            <div style="background:rgba(0,255,65,0.1);border:1px solid #00ff41;border-radius:10px;padding:15px;margin-top:15px;text-align:center;color:#00ff41;font-size:0.95em;letter-spacing:1px">
                ‚¨ÜÔ∏è Click ${analysis.prediction} button (glowing) ‚¨ÜÔ∏è
            </div>
        `;
    } else {
        currentPrediction = null;
        highlightPrediction(null);
        box.innerHTML = `
            <div class="prediction-reason">
                <div class="prediction-reason-text">${analysis.reason}</div>
            </div>
        `;
    }
}

function togglePrediction() {
    showPrediction = !showPrediction;
    const box = document.getElementById("predictionBox");
    
    if (showPrediction) {
        showPredictionResult();
        box.classList.add("show");
        document.getElementById("predictBtnText").textContent = "Hide Prediction";
    } else {
        currentPrediction = null;
        highlightPrediction(null);
        box.classList.remove("show");
        document.getElementById("predictBtnText").textContent = "AI Prediction (Need 50)";
    }
}

renderSlots();
updateWinLoss();
</body>
</html>
